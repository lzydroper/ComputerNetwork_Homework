分析：

分成两个部分

1. 获取许可证，输入字符串用户、口令，返回一个新的序列号，服务器记录该序列号已分发
2. 
   - 启动阶段：
     - 服务器启动时读取存储的连接表，并认为此前为崩溃，将连接表所有用户心跳时间设为现在，确保旧用户优先重连；
     - 客户端连接时，先判断是否为合法序列号，再判断人数上限；
   - 连接阶段：
     - 服务器每次成功连接时、客户端断连时更新存储表；
     - 服务器每间隔一段时间检查连接表，如果心跳超时则认为该客户端断连；
     - 客户端每间隔一段时间向服务器发送心跳，若发送失败，则等待重连，多次重连失败回退到启动；